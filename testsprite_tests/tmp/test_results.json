[
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "70e592f3-7d32-4b1a-8f41-dceab9683c86",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC001-post api ai missing userid returns 400",
    "description": "Verify that a POST request to /api/ai without the userId in the request body returns a 400 error indicating the missing user ID.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\n\ndef test_post_api_ai_missing_userid_returns_400():\n    base_url = \"http://localhost:3000\"\n    endpoint = f\"{base_url}/api/ai\"\n    auth = HTTPBasicAuth(\"recommendations@reply.pinterest.com\", \"recommendations@reply.pinterest.com\")\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    # Payload without userId\n    payload = {\n        \"prompt\": \"Generate something interesting.\",\n        \"model\": \"gpt-4\",\n        \"messages\": [{\"role\": \"user\", \"content\": \"Hello\"}]\n    }\n    try:\n        response = requests.post(endpoint, json=payload, headers=headers, auth=auth, timeout=30)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\n    assert response.status_code == 400, f\"Expected status code 400 but got {response.status_code}\"\n\n    # No assertion on error message to avoid false failures due to server message variation\n\ntest_post_api_ai_missing_userid_returns_400()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.719Z",
    "modified": "2025-12-18T19:58:13.135Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "a4726beb-24bc-49be-b9eb-113cb6cf2af6",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC002-post api ai valid userid returns generated content",
    "description": "Verify that a POST request to /api/ai with a valid userId retrieves and decrypts the API key correctly, calls the OpenRouter API, and returns the generated AI content with a 200 status.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\n\ndef test_post_api_ai_valid_userid_returns_generated_content():\n    base_url = \"http://localhost:3000\"\n    endpoint = f\"{base_url}/api/ai\"\n    auth = HTTPBasicAuth(\"recommendations@reply.pinterest.com\", \"recommendations@reply.pinterest.com\")\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    payload = {\n        \"userId\": \"valid-user-id-for-testing\",\n        \"prompt\": \"Generate a short AI text\",\n        \"model\": \"default\",\n        \"messages\": []\n    }\n\n    try:\n        response = requests.post(endpoint, json=payload, headers=headers, auth=auth, timeout=30)\n        assert response.status_code == 200, f\"Expected status code 200, got {response.status_code}\"\n        json_response = response.json()\n        # Validate that generated content is present and non-empty\n        assert isinstance(json_response, dict), \"Response is not a JSON object\"\n        # Assuming response contains \"content\" or similar key with generated AI text\n        assert (\"content\" in json_response and isinstance(json_response[\"content\"], str) and len(json_response[\"content\"]) > 0) or \\\n               (\"result\" in json_response and isinstance(json_response[\"result\"], str) and len(json_response[\"result\"]) > 0), \\\n               \"Response JSON does not contain expected generated content\"\n    except requests.exceptions.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\ntest_post_api_ai_valid_userid_returns_generated_content()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 31, in <module>\n  File \"<string>\", line 20, in test_post_api_ai_valid_userid_returns_generated_content\nAssertionError: Expected status code 200, got 500\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.724Z",
    "modified": "2025-12-18T19:58:09.761Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "bb8e982b-f4d7-4fab-afc9-5a15b8916fa7",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC003-post api ai missing apikey returns 401",
    "description": "Verify that if the OpenRouter API key is missing or cannot be retrieved, the POST /api/ai endpoint returns a 401 error indicating the missing API key.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\n\ndef test_post_api_ai_missing_apikey_returns_401():\n    base_url = \"http://localhost:3000\"\n    endpoint = \"/api/ai\"\n    url = base_url + endpoint\n    auth = HTTPBasicAuth('recommendations@reply.pinterest.com', 'recommendations@reply.pinterest.com')\n\n    # Prepare payload with valid userId but simulate missing API key scenario\n    payload = {\n        \"userId\": \"test-user-id\",\n        \"prompt\": \"Test prompt\",\n        \"model\": \"test-model\",\n        \"messages\": []\n    }\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n\n    try:\n        response = requests.post(url, json=payload, headers=headers, auth=auth, timeout=30)\n        # Assert that the response status code is 401 Unauthorized due to missing API key\n        assert response.status_code == 401, f\"Expected status code 401 but got {response.status_code}\"\n        # Optionally check if response content/message indicates missing API key\n        assert \"missing\" in response.text.lower() or \"api key\" in response.text.lower(), \"Response does not indicate missing API key\"\n    except requests.RequestException as e:\n        assert False, f\"Request failed with exception: {e}\"\n\ntest_post_api_ai_missing_apikey_returns_401()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 30, in <module>\n  File \"<string>\", line 24, in test_post_api_ai_missing_apikey_returns_401\nAssertionError: Expected status code 401 but got 500\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.729Z",
    "modified": "2025-12-18T19:58:08.384Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "c672cdab-10b0-4685-8a6e-5af32790cf6c",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC004-post api ai openrouter api failure returns 500",
    "description": "Verify that if the OpenRouter API call fails during a POST /api/ai request, the endpoint returns a 500 Internal Server Error with an appropriate error message.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\n\ndef test_post_api_ai_openrouter_api_failure_returns_500():\n    base_url = \"http://localhost:3000\"\n    endpoint = f\"{base_url}/api/ai\"\n    auth = HTTPBasicAuth(\"recommendations@reply.pinterest.com\", \"recommendations@reply.pinterest.com\")\n    headers = {\"Content-Type\": \"application/json\"}\n    # Prepare a typical valid request body including required userId and some prompt\n    payload = {\n        \"userId\": \"test-user-123\",\n        \"prompt\": \"Test prompt to generate AI content\",\n        \"model\": \"test-model\"\n    }\n\n    # We expect the underlying OpenRouter API call to fail and cause a 500 response.\n    # Since we can't cause the actual OpenRouter failure externally here,\n    # this test should be run in environment where OpenRouter API failure is simulated.\n    # The test validates that POST /api/ai returns a 500 status and proper error message.\n\n    try:\n        response = requests.post(endpoint, json=payload, headers=headers, auth=auth, timeout=30)\n    except requests.RequestException as e:\n        assert False, f\"Request to {endpoint} failed with exception: {e}\"\n\n    assert response.status_code == 500, f\"Expected status code 500 but got {response.status_code}\"\n\n    # Expect response JSON has an error message indicating internal server error\n    try:\n        json_response = response.json()\n    except ValueError:\n        assert False, \"Response is not valid JSON\"\n\n    # Check that response contains an error message key or meaningful message\n    assert (\n        \"error\" in json_response or \"message\" in json_response\n    ), \"Response JSON must include an error message field\"\n\ntest_post_api_ai_openrouter_api_failure_returns_500()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.735Z",
    "modified": "2025-12-18T19:58:06.303Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "5f3f3258-03c3-4261-9c99-b7d600f6dcef",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC005-get api ai stream maintains continuous streaming",
    "description": "Verify that connecting to the /api/ai/stream endpoint delivers AI-generated content in a continuous streaming manner without premature disconnections or timeouts.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\n\ndef test_tc005_get_api_ai_stream_continuous_streaming():\n    base_url = \"http://localhost:3000\"\n    endpoint = \"/api/ai/stream\"\n    url = base_url + endpoint\n    auth = HTTPBasicAuth(\"recommendations@reply.pinterest.com\", \"recommendations@reply.pinterest.com\")\n    headers = {\n        \"Accept\": \"text/event-stream\",\n    }\n    timeout_seconds = 30\n\n    try:\n        with requests.get(url, headers=headers, auth=auth, stream=True, timeout=timeout_seconds) as response:\n            # Validate response status\n            assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n\n            # Ensure response is chunked streaming\n            assert response.headers.get(\"Content-Type\") in (\"text/event-stream\", \"application/octet-stream\"), \\\n                f\"Unexpected Content-Type: {response.headers.get('Content-Type')}\"\n\n            chunk_count = 0\n            max_chunks_to_check = 5\n            # Read streaming data chunks to verify continuous flow without premature disconnect\n            for chunk in response.iter_content(chunk_size=None, decode_unicode=True):\n                if chunk:\n                    chunk_count += 1\n                    # Check that content chunks are not empty strings or just whitespace\n                    assert chunk.strip() != \"\", \"Received empty chunk indicating potential premature disconnect\"\n                # Stop after checking a few chunks to avoid long test duration\n                if chunk_count >= max_chunks_to_check:\n                    break\n\n            assert chunk_count > 0, \"No data chunks received from stream, streaming may be broken\"\n\n    except requests.exceptions.Timeout:\n        assert False, \"Request timed out prematurely, streaming endpoint not maintaining continuous streaming\"\n    except requests.exceptions.RequestException as e:\n        assert False, f\"Request error occurred: {e}\"\n\ntest_tc005_get_api_ai_stream_continuous_streaming()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 42, in <module>\n  File \"<string>\", line 17, in test_tc005_get_api_ai_stream_continuous_streaming\nAssertionError: Expected status 200, got 405\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.740Z",
    "modified": "2025-12-18T19:58:08.405Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "20642875-2397-488c-9e9e-27091de071d7",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC006-pages api enforces ownership and permission checks",
    "description": "Verify that the Pages API endpoints reject unauthorized access attempts to pages owned by other users and allow permitted users to create, read, update, or delete their own pages.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3000/api/pages\"\n# Using placeholder token for authorization header as per PRD token based auth\nAUTH_TOKEN = \"Bearer your_valid_token_here\"\nHEADERS = {\"Content-Type\": \"application/json\", \"Authorization\": AUTH_TOKEN}\nTIMEOUT = 30\n\ndef test_pages_api_enforces_ownership_and_permission_checks():\n    # Create a new page as authorized user\n    create_payload = {\n        \"title\": \"Test Page Ownership\",\n        \"content\": \"This is a test page to check ownership and permissions.\"\n    }\n    page_id = None\n\n    try:\n        # Create page (should succeed)\n        create_response = requests.post(\n            BASE_URL,\n            json=create_payload,\n            headers=HEADERS,\n            timeout=TIMEOUT,\n        )\n        assert create_response.status_code == 201 or create_response.status_code == 200\n        create_data = create_response.json()\n        assert \"id\" in create_data\n        page_id = create_data.get(\"id\")\n        assert page_id is not None\n\n        # Try to access the page with the same user (should succeed)\n        get_response = requests.get(\n            f\"{BASE_URL}/{page_id}\",\n            headers=HEADERS,\n            timeout=TIMEOUT,\n        )\n        assert get_response.status_code == 200\n        get_data = get_response.json()\n        assert get_data.get(\"id\") == page_id\n\n        # Try to update the page with the same user (should succeed)\n        update_payload = {\"title\": \"Updated Test Page Ownership\"}\n        update_response = requests.put(\n            f\"{BASE_URL}/{page_id}\",\n            json=update_payload,\n            headers=HEADERS,\n            timeout=TIMEOUT,\n        )\n        assert update_response.status_code == 200\n        update_data = update_response.json()\n        assert update_data.get(\"title\") == update_payload[\"title\"]\n\n        # Try to delete the page with the same user (should succeed)\n        delete_response = requests.delete(\n            f\"{BASE_URL}/{page_id}\",\n            headers=HEADERS,\n            timeout=TIMEOUT,\n        )\n        assert delete_response.status_code == 204 or delete_response.status_code == 200\n\n        # Now create another page to test unauthorized access\n        create_response_2 = requests.post(\n            BASE_URL,\n            json=create_payload,\n            headers=HEADERS,\n            timeout=TIMEOUT,\n        )\n        assert create_response_2.status_code == 201 or create_response_2.status_code == 200\n        data_2 = create_response_2.json()\n        assert \"id\" in data_2\n        page_id_2 = data_2.get(\"id\")\n        assert page_id_2 is not None\n\n        try:\n            # Unauthorized user credentials (different user)\n            # For unauthorized, use no Authorization header or an invalid token\n            unauthorized_headers = {\"Content-Type\": \"application/json\", \"Authorization\": \"Bearer invalid_token\"}\n\n            # Attempt to read the page owned by original user (should be rejected)\n            get_unauth_response = requests.get(\n                f\"{BASE_URL}/{page_id_2}\",\n                headers=unauthorized_headers,\n                timeout=TIMEOUT,\n            )\n            assert get_unauth_response.status_code in (401, 403)\n\n            # Attempt to update the page owned by original user (should be rejected)\n            update_payload_unauth = {\"title\": \"Unauthorized Update Attempt\"}\n            update_unauth_response = requests.put(\n                f\"{BASE_URL}/{page_id_2}\",\n                json=update_payload_unauth,\n                headers=unauthorized_headers,\n                timeout=TIMEOUT,\n            )\n            assert update_unauth_response.status_code in (401, 403)\n\n            # Attempt to delete the page owned by original user (should be rejected)\n            delete_unauth_response = requests.delete(\n                f\"{BASE_URL}/{page_id_2}\",\n                headers=unauthorized_headers,\n                timeout=TIMEOUT,\n            )\n            assert delete_unauth_response.status_code in (401, 403)\n        finally:\n            # Clean up second created page with authorized user\n            requests.delete(\n                f\"{BASE_URL}/{page_id_2}\",\n                headers=HEADERS,\n                timeout=TIMEOUT,\n            )\n    finally:\n        if page_id:\n            # Ensure cleanup for first created page in case of test failure before deletion\n            requests.delete(\n                f\"{BASE_URL}/{page_id}\",\n                headers=HEADERS,\n                timeout=TIMEOUT,\n            )\n\ntest_pages_api_enforces_ownership_and_permission_checks()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 120, in <module>\n  File \"<string>\", line 25, in test_pages_api_enforces_ownership_and_permission_checks\nAssertionError\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.745Z",
    "modified": "2025-12-18T19:58:50.493Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "ad142e11-52f3-403f-b5dc-285294e7e5a7",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC007-invitations api updates firestore state correctly",
    "description": "Verify that sending and accepting workspace invitations via the Invitations API correctly updates the Firestore database state, reflecting new members and permissions without inconsistencies.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\nimport time\n\nBASE_URL = \"http://localhost:3000\"\nAUTH = HTTPBasicAuth(\"recommendations@reply.pinterest.com\", \"recommendations@reply.pinterest.com\")\nHEADERS = {\"Content-Type\": \"application/json\"}\nTIMEOUT = 30\n\ndef test_invitations_api_updates_firestore_state_correctly():\n    invitation_id = None\n    workspace_id = None\n    inviter_user_id = \"user_inviter_123\"\n    invitee_email = \"invitee@example.com\"\n    invitee_user_id = None\n    # Step 1: Create a workspace\n    try:\n        workspace_payload = {\n            \"name\": \"Test Workspace for Invitations\",\n            \"ownerId\": inviter_user_id\n        }\n        r_ws = requests.post(f\"{BASE_URL}/api/workspaces\", auth=AUTH, json=workspace_payload, headers=HEADERS, timeout=TIMEOUT)\n        assert r_ws.status_code == 201, f\"Failed to create workspace: {r_ws.text}\"\n        workspace_data = r_ws.json()\n        workspace_id = workspace_data.get(\"id\")\n        assert workspace_id, \"Workspace ID not returned\"\n\n        # Step 2: Send invitation to invitee via Invitations API\n        invitation_payload = {\n            \"workspaceId\": workspace_id,\n            \"email\": invitee_email\n        }\n        r_invite = requests.post(f\"{BASE_URL}/api/invitations\", auth=AUTH, json=invitation_payload, headers=HEADERS, timeout=TIMEOUT)\n        assert r_invite.status_code == 201, f\"Failed to send invitation: {r_invite.text}\"\n        invitation_data = r_invite.json()\n        invitation_id = invitation_data.get(\"id\")\n        assert invitation_id, \"Invitation ID not returned\"\n        assert invitation_data.get(\"email\") == invitee_email\n        assert invitation_data.get(\"workspaceId\") == workspace_id\n        assert invitation_data.get(\"status\") == \"pending\"\n\n        # Simulate retrieving invitee user ID somehow (in real scenario might come from invitee user creation or lookup)\n        # For testing, assume invitee_user_id is known or created prior\n        # Here, for simulation, create invitee user:\n        invitee_user_payload = {\n            \"email\": invitee_email,\n            \"name\": \"Invitee User\"\n        }\n        r_invitee_user = requests.post(f\"{BASE_URL}/api/users\", auth=AUTH, json=invitee_user_payload, headers=HEADERS, timeout=TIMEOUT)\n        assert r_invitee_user.status_code == 201, f\"Failed to create invitee user: {r_invitee_user.text}\"\n        invitee_user = r_invitee_user.json()\n        invitee_user_id = invitee_user.get(\"id\")\n        assert invitee_user_id, \"Invitee User ID not returned\"\n\n        # Step 3: Accept the invitation as the invitee\n        accept_payload = {\n            \"invitationId\": invitation_id,\n            \"userId\": invitee_user_id\n        }\n        r_accept = requests.post(f\"{BASE_URL}/api/invitations/accept\", auth=AUTH, json=accept_payload, headers=HEADERS, timeout=TIMEOUT)\n        assert r_accept.status_code == 200, f\"Failed to accept invitation: {r_accept.text}\"\n        accept_response = r_accept.json()\n        assert accept_response.get(\"status\") == \"accepted\"\n\n        # Step 4: Verify Firestore state - verify invitee is a member of the workspace with correct permissions\n        # Typically we'd call an API or DB to verify - assume there is an endpoint to get workspace members:\n        r_members = requests.get(f\"{BASE_URL}/api/workspaces/{workspace_id}/members\", auth=AUTH, headers=HEADERS, timeout=TIMEOUT)\n        assert r_members.status_code == 200, f\"Failed to get workspace members: {r_members.text}\"\n        members = r_members.json()\n        member_ids = [m.get(\"userId\") for m in members]\n        assert invitee_user_id in member_ids, \"Invitee user is not a member of the workspace after acceptance\"\n\n        # Verify permissions for invitee user\n        invitee_member = next((m for m in members if m.get(\"userId\") == invitee_user_id), None)\n        assert invitee_member is not None, \"Invitee member record not found in workspace\"\n        permissions = invitee_member.get(\"permissions\")\n        assert permissions is not None, \"Permissions not set for invitee\"\n        assert \"read\" in permissions or \"write\" in permissions or \"admin\" in permissions, \"Invitee permissions are insufficient\"\n\n    finally:\n        # Cleanup: delete invitation, invitee user, workspace\n        if invitation_id:\n            requests.delete(f\"{BASE_URL}/api/invitations/{invitation_id}\", auth=AUTH, headers=HEADERS, timeout=TIMEOUT)\n        if invitee_user_id:\n            requests.delete(f\"{BASE_URL}/api/users/{invitee_user_id}\", auth=AUTH, headers=HEADERS, timeout=TIMEOUT)\n        if workspace_id:\n            requests.delete(f\"{BASE_URL}/api/workspaces/{workspace_id}\", auth=AUTH, headers=HEADERS, timeout=TIMEOUT)\n\ntest_invitations_api_updates_firestore_state_correctly()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 89, in <module>\n  File \"<string>\", line 23, in test_invitations_api_updates_firestore_state_correctly\nAssertionError: Failed to create workspace: <!DOCTYPE html><html lang=\"en\"><head><meta charSet=\"utf-8\"/><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"/><link rel=\"stylesheet\" href=\"/_next/static/chunks/%5Broot-of-the-server%5D__0f0ba101._.css\" data-precedence=\"next_static/chunks/[root-of-the-server]__0f0ba101._.css\"/><link rel=\"preload\" as=\"script\" fetchPriority=\"low\" href=\"/_next/static/chunks/%5Bturbopack%5D_browser_dev_hmr-client_hmr-client_ts_bae88007._.js\"/><script src=\"/_next/static/chunks/node_modules_next_dist_compiled_react-dom_1e674e59._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_next_dist_compiled_react-server-dom-turbopack_9212ccad._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_next_dist_compiled_next-devtools_index_1dd7fb59.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_next_dist_compiled_a0e4c7b4._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_next_dist_client_aaee43fe._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_next_dist_7a8122d0._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_%40swc_helpers_cjs_d80fb378._.js\" async=\"\"></script><script src=\"/_next/static/chunks/_a0ff3932._.js\" async=\"\"></script><script src=\"/_next/static/chunks/turbopack-_45210fd5._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\" async=\"\"></script><script src=\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_%40firebase_auth_dist_esm_940b9c9a._.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_%40firebase_firestore_dist_index_esm_af799df8.js\" async=\"\"></script><script src=\"/_next/static/chunks/node_modules_927c600b._.js\" async=\"\"></script><script src=\"/_next/static/chunks/src_105853ba._.js\" async=\"\"></script><script src=\"/_next/static/chunks/src_app_layout_tsx_78cdd4a3._.js\" async=\"\"></script><meta name=\"robots\" content=\"noindex\"/><meta name=\"next-size-adjust\" content=\"\"/><title>404: This page could not be found.</title><title>Note Service</title><meta name=\"description\" content=\"Advanced Note App\"/><link rel=\"icon\" href=\"/favicon.ico?favicon.0b3bf435.ico\" sizes=\"256x256\" type=\"image/x-icon\"/><script src=\"/_next/static/chunks/node_modules_next_dist_build_polyfills_polyfill-nomodule.js\" noModule=\"\"></script></head><body class=\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\"><div hidden=\"\"><!--$--><!--/$--></div><script>((e, i, s, u, m, a, l, h)=>{\n    let d = document.documentElement, w = [\n        \"light\",\n        \"dark\"\n    ];\n    function p(n) {\n        (Array.isArray(e) ? e : [\n            e\n        ]).forEach((y)=>{\n            let k = y === \"class\", S = k && a ? m.map((f)=>a[f] || f) : m;\n            k ? (d.classList.remove(...S), d.classList.add(a && a[n] ? a[n] : n)) : d.setAttribute(y, n);\n        }), R(n);\n    }\n    function R(n) {\n        h && w.includes(n) && (d.style.colorScheme = n);\n    }\n    function c() {\n        return window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\";\n    }\n    if (u) p(u);\n    else try {\n        let n = localStorage.getItem(i) || s, y = l && n === \"system\" ? c() : n;\n        p(y);\n    } catch (n) {}\n})(\"class\",\"theme\",\"system\",null,[\"light\",\"dark\"],null,true,true)</script><div style=\"font-family:system-ui,&quot;Segoe UI&quot;,Roboto,Helvetica,Arial,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;;height:100vh;text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center\"><div><style>body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}</style><h1 class=\"next-error-h1\" style=\"display:inline-block;margin:0 20px 0 0;padding:0 23px 0 0;font-size:24px;font-weight:500;vertical-align:top;line-height:49px\">404</h1><div style=\"display:inline-block\"><h2 style=\"font-size:14px;font-weight:400;line-height:49px;margin:0\">This page could not be found.</h2></div></div></div><!--$--><!--/$--><section aria-label=\"Notifications alt+T\" tabindex=\"-1\" aria-live=\"polite\" aria-relevant=\"additions text\" aria-atomic=\"false\"></section><section aria-label=\"Notifications alt+T\" tabindex=\"-1\" aria-live=\"polite\" aria-relevant=\"additions text\" aria-atomic=\"false\"></section><script id=\"_R_\">self.__next_r=\"GIDOhJ8rDzk5AUmCdKdSd\"</script><script src=\"/_next/static/chunks/%5Bturbopack%5D_browser_dev_hmr-client_hmr-client_ts_bae88007._.js\" async=\"\"></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,\"5:I[\\\"[project]/node_modules/next/dist/next-devtools/userspace/app/segment-explorer-node.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"SegmentViewNode\\\"]\\n7:\\\"$Sreact.fragment\\\"\\n1b:I[\\\"[project]/src/components/ErrorBoundary.tsx [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_%40firebase_auth_dist_esm_940b9c9a._.js\\\",\\\"/_next/static/chunks/node_modules_%40firebase_firestore_dist_index_esm_af799df8.js\\\",\\\"/_next/static/chunks/node_modules_927c600b._.js\\\",\\\"/_next/static/chunks/src_105853ba._.js\\\",\\\"/_next/static/chunks/src_app_layout_tsx_78cdd4a3._.js\\\"],\\\"ErrorBoundary\\\"]\\n1d:I[\\\"[project]/src/components/ThemeProvider.tsx [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_%40firebase_auth_dist_esm_940b9c9a._.js\\\",\\\"/_next/static/chunks/node_modules_%40firebase_firestore_dist_index_esm_af799df8.js\\\",\\\"/_next/static/chunks/node_modules_927c600b._.js\\\",\\\"/_next/static/chunks/src_105853ba._.js\\\",\\\"/_next/static/chunks/src_app_layout_tsx_78cdd4a3._.js\\\"],\\\"ThemeProvider\\\"]\\n1f:I[\\\"[project]/src/context/AuthContext.tsx [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_%40firebase_auth_dist_esm_940b9c9a._.js\\\",\\\"/_next/static/chunks/node_modules_%40firebase_firestore_dist_index_esm_af799df8.js\\\",\\\"/_next/static/chunks/node_modules_927c600b._.js\\\",\\\"/_next/static/chunks/src_105853ba._.js\\\",\\\"/_next/static/chunks/src_app_layout_tsx_78cdd4a3._.js\\\"],\\\"AuthProvider\\\"]\\n21:I[\\\"[project]/node_modules/next/dist/client/components/layout-router.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"default\\\"]\\n23:I[\\\"[project]/node_modules/next/dist/client/components/render-from-template-context.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"default\\\"]\\n31:I[\\\"[project]/node_modules/sonner/dist/index.mjs [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_%40firebase_auth_dist_esm_940b9c9a._.js\\\",\\\"/_next/static/chunks/node_modules_%40firebase_firestore_dist_index_esm_af799df8.js\\\",\\\"/_next/static/chunks/node_modules_927c600b._.js\\\",\\\"/_next/static/chunks/src_105853ba._.js\\\",\\\"/_next/static/chunks/src_app_layout_tsx_78cdd4a3._.js\\\"],\\\"Toaster\\\"]\\n47:I[\\\"[project]/node_modules/next/dist/lib/framework/boundary-components.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"OutletBoundary\\\"]\\n49:\\\"$Sreact.suspense\\\"\\n53:I[\\\"[project]/node_modules/next/dist/lib/framework/boundary-components.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"ViewportBoundary\\\"]\\n59:I[\\\"[project]/node_modules/next/dist/lib/framework/boundary-components.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"MetadataBoundary\\\"]\\n5e:I[\\\"[project]/node_modules/next/dist/client/components/builtin/global-error.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"default\\\"]\\n65:I[\\\"[project]/node_modules/next/dist/lib/metadata/generate/icon-mark.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"IconMark\\\"]\\n:HL[\\\"/_next/static/chunks/%5Broot-of-the-server%5D__0f0ba101._.css\\\",\\\"style\\\"]\\n:N1766087887925.6042\\n3:\\\"$EObject.defineProperty(()=\\u003e{ctx.componentMod.preloadStyle(fullHref,ctx.renderOpts.crossOrigin,ctx.nonce)},\\\\\\\"name\\\\\\\",{value:\\\\\\\"\\\\\\\"})\\\"\\n2:{\\\"name\\\":\\\"Preloads\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[],\\\"props\\\":{\\\"preloadCallbacks\\\":[\\\"$3\\\"]}}\\n4:[]\\n6:[]\\n8:[[\\\"Array.map\\\",\\\"\\\",0,0,0,0,false]]\\n9:[[\\\"Array.map\\\",\\\"\\\",0,0,0,0,false]]\\na:[[\\\"Array.map\\\",\\\"\\\",0,0,0,0,false]]\\nb:[[\\\"Array.map\\\",\\\"\\\",0,0,0,0,false]]\\nc:[[\\\"Array.map\\\"\"])</script><script>self.__next_f.push([1,\",\\\"\\\",0,0,0,0,false]]\\nd:[[\\\"Array.map\\\",\\\"\\\",0,0,0,0,false]]\\n10:I[\\\"[project]/node_modules/next/dist/client/components/layout-router.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"default\\\"]\\n13:I[\\\"[project]/node_modules/next/dist/client/components/render-from-template-context.js [app-client] (ecmascript)\\\",[\\\"/_next/static/chunks/node_modules_next_dist_094231d7._.js\\\",\\\"/_next/static/chunks/src_app_favicon_ico_mjs_a4dcd48c._.js\\\"],\\\"default\\\"]\\n14:{}\\n15:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n12:{\\\"children\\\":[\\\"$\\\",\\\"$L13\\\",null,\\\"$14\\\",null,\\\"$15\\\",1]}\\n16:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n11:{\\\"parallelRouterKey\\\":\\\"children\\\",\\\"error\\\":\\\"$undefined\\\",\\\"errorStyles\\\":\\\"$undefined\\\",\\\"errorScripts\\\":\\\"$undefined\\\",\\\"template\\\":[\\\"$\\\",\\\"$7\\\",null,\\\"$12\\\",null,\\\"$16\\\",0],\\\"templateStyles\\\":\\\"$undefined\\\",\\\"templateScripts\\\":\\\"$undefined\\\",\\\"notFound\\\":\\\"$Y\\\",\\\"forbidden\\\":\\\"$undefined\\\",\\\"unauthorized\\\":\\\"$undefined\\\",\\\"segmentViewBoundaries\\\":\\\"$Y\\\"}\\n17:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\nf:{\\\"name\\\":\\\"RootLayout\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[],\\\"props\\\":{\\\"children\\\":[\\\"$\\\",\\\"$L10\\\",null,\\\"$11\\\",null,\\\"$17\\\",1],\\\"params\\\":\\\"$Y\\\"}}\\n18:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",205,263,204,1,false]]\\n19:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",208,270,204,1,false]]\\n1a:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",211,268,204,1,false]]\\n1c:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",212,282,204,1,false]]\\n1e:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",217,286,204,1,false]]\\n20:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n22:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n24:[]\\n26:{\\\"name\\\":\\\"NotFound\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[],\\\"props\\\":{}}\\n27:{\\\"name\\\":\\\"HTTPAccessErrorFallback\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"owner\\\":\\\"$26\\\",\\\"stack\\\":[],\\\"props\\\":{\\\"status\\\":404,\\\"message\\\":\\\"This page could not be found.\\\"}}\\n28:[]\\n29:[]\\n2a:[]\\n2b:[]\\n2c:[]\\n2d:[]\\n2e:[]\\n2f:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n30:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",220,284,204,1,false]]\\n32:[[\\\"RootLayout\\\",\\\"/Users/junsu/Desktop/Projects/note-web/.next/dev/server/chunks/ssr/[root-of-the-server]__8313ef66._.js\\\",244,268,204,1,false]]\\n33:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n34:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true],[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n35:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true],[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n36:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true],[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n37:[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true],[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]]\\n39:{\\\"name\\\":\\\"NotFound\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true],[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]],\\\"props\\\":{\\\"params\\\":\\\"$@3a\\\",\\\"searchParams\\\":\\\"$@3b\\\"}}\\n3c:{\\\"name\\\":\\\"HTTPAccessErrorFallback\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"owner\\\":\\\"$39\\\",\\\"stack\\\":[],\\\"props\\\":{\\\"status\\\":404,\\\"message\\\":\\\"This page could not be found.\\\"}}\\n3d:[]\\n3e:[]\\n3f:[]\\n40:[]\\n41:[]\\n42:[]\\n43:[]\\n45:{\\\"name\\\":\\\"Next.MetadataOutlet\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true],[\\\"Promise.all\\\",\\\"\\\",0,0,0,0,true]],\\\"props\\\":{}}\\n46:[]\\n48:[]\\n4b:[]\\n\"])</script><script>self.__next_f.push([1,\"4e:\\\"$EObject.defineProperty(function(type,config,children){for(var propName,i=2;i\\u003carguments.length;i++)validateChildKeys(arguments[i]);i={};var key=null;if(null!=config)for(propName in didWarnAboutOldJSXRuntime||!(\\\\\\\"__self\\\\\\\"in config)||\\\\\\\"key\\\\\\\"in config||(didWarnAboutOldJSXRuntime=!0,console.warn(\\\\\\\"Your app (or one of its dependencies) is using an outdated JSX transform. Update to the modern JSX transform for faster performance: https://react.dev/link/new-jsx-transform\\\\\\\")),hasValidKey(config)\\u0026\\u0026(checkKeyStringCoercion(config.key),key=\\\\\\\"\\\\\\\"+config.key),config)hasOwnProperty.call(config,propName)\\u0026\\u0026\\\\\\\"key\\\\\\\"!==propName\\u0026\\u0026\\\\\\\"__self\\\\\\\"!==propName\\u0026\\u0026\\\\\\\"__source\\\\\\\"!==propName\\u0026\\u0026(i[propName]=config[propName]);var childrenLength=arguments.length-2;if(1===childrenLength)i.children=children;else if(1\\u003cchildrenLength){for(var childArray=Array(childrenLength),_i=0;_i\\u003cchildrenLength;_i++)childArray[_i]=arguments[_i+2];Object.freeze\\u0026\\u0026Object.freeze(childArray),i.children=childArray}if(type\\u0026\\u0026type.defaultProps)for(propName in childrenLength=type.defaultProps)void 0===i[propName]\\u0026\\u0026(i[propName]=childrenLength[propName]);return key\\u0026\\u0026function(props,displayName){function warnAboutAccessingKey(){specialPropKeyWarningShown||(specialPropKeyWarningShown=!0,console.error(\\\\\\\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)\\\\\\\",displayName))}warnAboutAccessingKey.isReactWarning=!0,Object.defineProperty(props,\\\\\\\"key\\\\\\\",{get:warnAboutAccessingKey,configurable:!0})}(i,\\\\\\\"function\\\\\\\"==typeof type?type.displayName||type.name||\\\\\\\"Unknown\\\\\\\":type),(propName=1e4\\u003eReactSharedInternals.recentlyCreatedOwnerStacks++)?(childArray=Error.stackTraceLimit,Error.stackTraceLimit=10,childrenLength=Error(\\\\\\\"react-stack-top-frame\\\\\\\"),Error.stackTraceLimit=childArray):childrenLength=unknownOwnerDebugStack,ReactElement(type,key,i,getOwner(),childrenLength,propName?createTask(getTaskName(type)):unknownOwnerDebugTask)},\\\\\\\"name\\\\\\\",{value:\\\\\\\"\\\\\\\"})\\\"\\n\"])</script><script>self.__next_f.push([1,\"4d:{\\\"name\\\":\\\"NonIndex\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[],\\\"props\\\":{\\\"createElement\\\":\\\"$4e\\\",\\\"pagePath\\\":\\\"/_not-found\\\",\\\"statusCode\\\":404,\\\"isPossibleServerAction\\\":false}}\\n4f:[]\\n51:{\\\"name\\\":\\\"Next.Viewport\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[],\\\"props\\\":{}}\\n52:[]\\n56:{\\\"name\\\":\\\"Next.Metadata\\\",\\\"key\\\":null,\\\"env\\\":\\\"Server\\\",\\\"stack\\\":[],\\\"props\\\":{}}\\n57:[]\\n58:[]\\n5a:[]\\n5c:[]\\n3a:{}\\n3b:\\n5f:[]\\n60:[]\\n61:[]\\n62:[]\\n63:[[\\\"Array.map\\\",\\\"\\\",0,0,0,0,false]]\\n64:[]\\n1:D{\\\"time\\\":0.9393330000166316}\\n1:D\\\"$2\\\"\\n1:D{\\\"time\\\":1.1190000000060536}\\n1:null\\ne:D{\\\"time\\\":1.9357920000038575}\\ne:D\\\"$f\\\"\\ne:D{\\\"time\\\":2.3843329999945126}\\n25:D{\\\"time\\\":2.5689169999968726}\\n25:D\\\"$26\\\"\\n25:D{\\\"time\\\":2.7084170000161976}\\n25:D\\\"$27\\\"\\n25:D{\\\"time\\\":2.849167000007583}\\n25:[[\\\"$\\\",\\\"title\\\",null,{\\\"children\\\":\\\"404: This page could not be found.\\\"},\\\"$27\\\",\\\"$28\\\",1],[\\\"$\\\",\\\"div\\\",null,{\\\"style\\\":{\\\"fontFamily\\\":\\\"system-ui,\\\\\\\"Segoe UI\\\\\\\",Roboto,Helvetica,Arial,sans-serif,\\\\\\\"Apple Color Emoji\\\\\\\",\\\\\\\"Segoe UI Emoji\\\\\\\"\\\",\\\"height\\\":\\\"100vh\\\",\\\"textAlign\\\":\\\"center\\\",\\\"display\\\":\\\"flex\\\",\\\"flexDirection\\\":\\\"column\\\",\\\"alignItems\\\":\\\"center\\\",\\\"justifyContent\\\":\\\"center\\\"},\\\"children\\\":[\\\"$\\\",\\\"div\\\",null,{\\\"children\\\":[[\\\"$\\\",\\\"style\\\",null,{\\\"dangerouslySetInnerHTML\\\":{\\\"__html\\\":\\\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\\\"}},\\\"$27\\\",\\\"$2b\\\",1],[\\\"$\\\",\\\"h1\\\",null,{\\\"className\\\":\\\"next-error-h1\\\",\\\"style\\\":{\\\"display\\\":\\\"inline-block\\\",\\\"margin\\\":\\\"0 20px 0 0\\\",\\\"padding\\\":\\\"0 23px 0 0\\\",\\\"fontSize\\\":24,\\\"fontWeight\\\":500,\\\"verticalAlign\\\":\\\"top\\\",\\\"lineHeight\\\":\\\"49px\\\"},\\\"children\\\":404},\\\"$27\\\",\\\"$2c\\\",1],[\\\"$\\\",\\\"div\\\",null,{\\\"style\\\":{\\\"display\\\":\\\"inline-block\\\"},\\\"children\\\":[\\\"$\\\",\\\"h2\\\",null,{\\\"style\\\":{\\\"fontSize\\\":14,\\\"fontWeight\\\":400,\\\"lineHeight\\\":\\\"49px\\\",\\\"margin\\\":0},\\\"children\\\":\\\"This page could not be found.\\\"},\\\"$27\\\",\\\"$2e\\\",1]},\\\"$27\\\",\\\"$2d\\\",1]]},\\\"$27\\\",\\\"$2a\\\",1]},\\\"$27\\\",\\\"$29\\\",1]]\\ne:[\\\"$\\\",\\\"html\\\",null,{\\\"lang\\\":\\\"en\\\",\\\"suppressHydrationWarning\\\":true,\\\"children\\\":[\\\"$\\\",\\\"body\\\",null,{\\\"className\\\":\\\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\\\",\\\"children\\\":[[\\\"$\\\",\\\"$L1b\\\",null,{\\\"children\\\":[\\\"$\\\",\\\"$L1d\\\",null,{\\\"attribute\\\":\\\"class\\\",\\\"defaultTheme\\\":\\\"system\\\",\\\"enableSystem\\\":true,\\\"disableTransitionOnChange\\\":true,\\\"children\\\":[\\\"$\\\",\\\"$L1f\\\",null,{\\\"children\\\":[[\\\"$\\\",\\\"$L21\\\",null,{\\\"parallelRouterKey\\\":\\\"children\\\",\\\"error\\\":\\\"$undefined\\\",\\\"errorStyles\\\":\\\"$undefined\\\",\\\"errorScripts\\\":\\\"$undefined\\\",\\\"template\\\":[\\\"$\\\",\\\"$L23\\\",null,{},null,\\\"$22\\\",1],\\\"templateStyles\\\":\\\"$undefined\\\",\\\"templateScripts\\\":\\\"$undefined\\\",\\\"notFound\\\":[\\\"$\\\",\\\"$L5\\\",\\\"c-not-found\\\",{\\\"type\\\":\\\"not-found\\\",\\\"pagePath\\\":\\\"__next_builtin__not-found.js\\\",\\\"children\\\":[\\\"$25\\\",[]]},null,\\\"$24\\\",0],\\\"forbidden\\\":\\\"$undefined\\\",\\\"unauthorized\\\":\\\"$undefined\\\",\\\"segmentViewBoundaries\\\":[[\\\"$\\\",\\\"$L5\\\",null,{\\\"type\\\":\\\"boundary:not-found\\\",\\\"pagePath\\\":\\\"__next_builtin__not-found.js@boundary\\\"},null,\\\"$2f\\\",1],\\\"$undefined\\\",\\\"$undefined\\\",\\\"$undefined\\\"]},null,\\\"$20\\\",1],[\\\"$\\\",\\\"$L31\\\",null,{\\\"position\\\":\\\"top-center\\\",\\\"richColors\\\":true},\\\"$f\\\",\\\"$30\\\",1]]},\\\"$f\\\",\\\"$1e\\\",1]},\\\"$f\\\",\\\"$1c\\\",1]},\\\"$f\\\",\\\"$1a\\\",1],[\\\"$\\\",\\\"$L31\\\",null,{\\\"position\\\":\\\"top-right\\\",\\\"richColors\\\":true},\\\"$f\\\",\\\"$32\\\",1]]},\\\"$f\\\",\\\"$19\\\",1]},\\\"$f\\\",\\\"$18\\\",1]\\n38:D{\\\"time\\\":3.364292000012938}\\n38:D\\\"$39\\\"\\n38:D{\\\"time\\\":3.396082999999635}\\n38:D\\\"$3c\\\"\\n38:D{\\\"time\\\":3.454708000004757}\\n38:[[\\\"$\\\",\\\"title\\\",null,{\\\"children\\\":\\\"404: This page could not be found.\\\"},\\\"$3c\\\",\\\"$3d\\\",1],[\\\"$\\\",\\\"div\\\",null,{\\\"style\\\":\\\"$25:1:props:style\\\",\\\"children\\\":[\\\"$\\\",\\\"div\\\",null,{\\\"children\\\":[[\\\"$\\\",\\\"style\\\",null,{\\\"dangerouslySetInnerHTML\\\":{\\\"__html\\\":\\\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\\\"}},\\\"$3c\\\",\\\"$40\\\",1],[\\\"$\\\",\\\"h1\\\",null,{\\\"className\\\":\\\"next-error-h1\\\",\\\"style\\\":\\\"$25:1:props:children:props:children:1:props:style\\\",\\\"children\\\":404},\\\"$3c\\\",\\\"$41\\\",1],[\\\"$\\\",\\\"div\\\",null,{\\\"style\\\":\\\"$25:1:props:children:props:children:2:props:style\\\",\\\"children\\\":[\\\"$\\\",\\\"h2\\\",null,{\\\"style\\\":\\\"$25:1:props:children:props:children:2:props:children:props:style\\\",\\\"children\\\":\\\"This page could not be found.\\\"},\\\"$3c\\\",\\\"$43\\\",1]},\\\"$3c\\\",\\\"$42\\\",1]]},\\\"$3c\\\",\\\"$3f\\\",1]},\\\"\"])</script><script>self.__next_f.push([1,\"$3c\\\",\\\"$3e\\\",1]]\\n44:D{\\\"time\\\":3.5678330000082497}\\n44:D\\\"$45\\\"\\n44:D{\\\"time\\\":4.429124999995111}\\n44:[\\\"$\\\",\\\"$L47\\\",null,{\\\"children\\\":[\\\"$\\\",\\\"$49\\\",null,{\\\"name\\\":\\\"Next.MetadataOutlet\\\",\\\"children\\\":\\\"$@4a\\\"},\\\"$45\\\",\\\"$48\\\",1]},\\\"$45\\\",\\\"$46\\\",1]\\n4c:D{\\\"time\\\":4.642458000016632}\\n4c:D\\\"$4d\\\"\\n4c:D{\\\"time\\\":4.682125000021188}\\n4c:[\\\"$\\\",\\\"meta\\\",null,{\\\"name\\\":\\\"robots\\\",\\\"content\\\":\\\"noindex\\\"},\\\"$4d\\\",\\\"$4f\\\",1]\\n50:D{\\\"time\\\":4.718083000014303}\\n50:D\\\"$51\\\"\\n50:D{\\\"time\\\":4.782833000004757}\\n50:[\\\"$\\\",\\\"$L53\\\",null,{\\\"children\\\":\\\"$@54\\\"},\\\"$51\\\",\\\"$52\\\",1]\\n55:D{\\\"time\\\":4.866083000000799}\\n55:D\\\"$56\\\"\\n55:D{\\\"time\\\":4.941416999994544}\\n55:[\\\"$\\\",\\\"div\\\",null,{\\\"hidden\\\":true,\\\"children\\\":[\\\"$\\\",\\\"$L59\\\",null,{\\\"children\\\":[\\\"$\\\",\\\"$49\\\",null,{\\\"name\\\":\\\"Next.Metadata\\\",\\\"children\\\":\\\"$@5b\\\"},\\\"$56\\\",\\\"$5a\\\",1]},\\\"$56\\\",\\\"$58\\\",1]},\\\"$56\\\",\\\"$57\\\",1]\\n5d:[]\\n\"])</script><script>self.__next_f.push([1,\"0:{\\\"P\\\":\\\"$1\\\",\\\"b\\\":\\\"development\\\",\\\"c\\\":[\\\"\\\",\\\"api\\\",\\\"workspaces\\\"],\\\"q\\\":\\\"\\\",\\\"i\\\":false,\\\"f\\\":[[[\\\"\\\",{\\\"children\\\":[\\\"/_not-found\\\",{\\\"children\\\":[\\\"__PAGE__\\\",{}]}]},\\\"$undefined\\\",\\\"$undefined\\\",true],[[\\\"$\\\",\\\"$L5\\\",\\\"layout\\\",{\\\"type\\\":\\\"layout\\\",\\\"pagePath\\\":\\\"layout.tsx\\\",\\\"children\\\":[\\\"$\\\",\\\"$7\\\",\\\"c\\\",{\\\"children\\\":[[[\\\"$\\\",\\\"link\\\",\\\"0\\\",{\\\"rel\\\":\\\"stylesheet\\\",\\\"href\\\":\\\"/_next/static/chunks/%5Broot-of-the-server%5D__0f0ba101._.css\\\",\\\"precedence\\\":\\\"next_static/chunks/[root-of-the-server]__0f0ba101._.css\\\",\\\"crossOrigin\\\":\\\"$undefined\\\",\\\"nonce\\\":\\\"$undefined\\\"},null,\\\"$8\\\",0],[\\\"$\\\",\\\"script\\\",\\\"script-0\\\",{\\\"src\\\":\\\"/_next/static/chunks/node_modules_%40firebase_auth_dist_esm_940b9c9a._.js\\\",\\\"async\\\":true,\\\"nonce\\\":\\\"$undefined\\\"},null,\\\"$9\\\",0],[\\\"$\\\",\\\"script\\\",\\\"script-1\\\",{\\\"src\\\":\\\"/_next/static/chunks/node_modules_%40firebase_firestore_dist_index_esm_af799df8.js\\\",\\\"async\\\":true,\\\"nonce\\\":\\\"$undefined\\\"},null,\\\"$a\\\",0],[\\\"$\\\",\\\"script\\\",\\\"script-2\\\",{\\\"src\\\":\\\"/_next/static/chunks/node_modules_927c600b._.js\\\",\\\"async\\\":true,\\\"nonce\\\":\\\"$undefined\\\"},null,\\\"$b\\\",0],[\\\"$\\\",\\\"script\\\",\\\"script-3\\\",{\\\"src\\\":\\\"/_next/static/chunks/src_105853ba._.js\\\",\\\"async\\\":true,\\\"nonce\\\":\\\"$undefined\\\"},null,\\\"$c\\\",0],[\\\"$\\\",\\\"script\\\",\\\"script-4\\\",{\\\"src\\\":\\\"/_next/static/chunks/src_app_layout_tsx_78cdd4a3._.js\\\",\\\"async\\\":true,\\\"nonce\\\":\\\"$undefined\\\"},null,\\\"$d\\\",0]],\\\"$e\\\"]},null,\\\"$6\\\",1]},null,\\\"$4\\\",0],{\\\"children\\\":[[\\\"$\\\",\\\"$7\\\",\\\"c\\\",{\\\"children\\\":[null,[\\\"$\\\",\\\"$L21\\\",null,{\\\"parallelRouterKey\\\":\\\"children\\\",\\\"error\\\":\\\"$undefined\\\",\\\"errorStyles\\\":\\\"$undefined\\\",\\\"errorScripts\\\":\\\"$undefined\\\",\\\"template\\\":[\\\"$\\\",\\\"$L23\\\",null,{},null,\\\"$35\\\",1],\\\"templateStyles\\\":\\\"$undefined\\\",\\\"templateScripts\\\":\\\"$undefined\\\",\\\"notFound\\\":\\\"$undefined\\\",\\\"forbidden\\\":\\\"$undefined\\\",\\\"unauthorized\\\":\\\"$undefined\\\",\\\"segmentViewBoundaries\\\":[\\\"$undefined\\\",\\\"$undefined\\\",\\\"$undefined\\\",\\\"$undefined\\\"]},null,\\\"$34\\\",1]]},null,\\\"$33\\\",0],{\\\"children\\\":[[\\\"$\\\",\\\"$7\\\",\\\"c\\\",{\\\"children\\\":[[\\\"$\\\",\\\"$L5\\\",\\\"c-page\\\",{\\\"type\\\":\\\"page\\\",\\\"pagePath\\\":\\\"__next_builtin__not-found.js\\\",\\\"children\\\":\\\"$38\\\"},null,\\\"$37\\\",1],null,\\\"$44\\\"]},null,\\\"$36\\\",0],{},null,false,false]},null,false,false]},null,false,false],[\\\"$\\\",\\\"$7\\\",\\\"h\\\",{\\\"children\\\":[\\\"$4c\\\",\\\"$50\\\",\\\"$55\\\",[\\\"$\\\",\\\"meta\\\",null,{\\\"name\\\":\\\"next-size-adjust\\\",\\\"content\\\":\\\"\\\"},null,\\\"$5c\\\",1]]},null,\\\"$4b\\\",0],false]],\\\"m\\\":\\\"$W5d\\\",\\\"G\\\":[\\\"$5e\\\",\\\"$undefined\\\"],\\\"S\\\":false}\\n\"])</script><script>self.__next_f.push([1,\"54:D{\\\"time\\\":6.775125000014668}\\n54:[[\\\"$\\\",\\\"meta\\\",\\\"0\\\",{\\\"charSet\\\":\\\"utf-8\\\"},\\\"$45\\\",\\\"$5f\\\",0],[\\\"$\\\",\\\"meta\\\",\\\"1\\\",{\\\"name\\\":\\\"viewport\\\",\\\"content\\\":\\\"width=device-width, initial-scale=1\\\"},\\\"$45\\\",\\\"$60\\\",0]]\\n5b:D{\\\"time\\\":7.851875000022119}\\n5b:[[\\\"$\\\",\\\"title\\\",\\\"0\\\",{\\\"children\\\":\\\"Note Service\\\"},\\\"$45\\\",\\\"$61\\\",0],[\\\"$\\\",\\\"meta\\\",\\\"1\\\",{\\\"name\\\":\\\"description\\\",\\\"content\\\":\\\"Advanced Note App\\\"},\\\"$45\\\",\\\"$62\\\",0],[\\\"$\\\",\\\"link\\\",\\\"2\\\",{\\\"rel\\\":\\\"icon\\\",\\\"href\\\":\\\"/favicon.ico?favicon.0b3bf435.ico\\\",\\\"sizes\\\":\\\"256x256\\\",\\\"type\\\":\\\"image/x-icon\\\"},\\\"$45\\\",\\\"$63\\\",0],[\\\"$\\\",\\\"$L65\\\",\\\"3\\\",{},\\\"$45\\\",\\\"$64\\\",0]]\\n4a:D{\\\"time\\\":7.901582999998936}\\n4a:null\\n\"])</script></body></html>\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.750Z",
    "modified": "2025-12-18T19:58:13.879Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "8d2b9f46-d600-48ce-a2e7-083c0f9d43d5",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC008-authentication middleware validates tokens and prompts reauthentication",
    "description": "Verify that the authentication middleware validates user tokens on API calls, fails immediately on expired or invalid tokens, and prompts the user to reauthenticate.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\n\nBASE_URL = \"http://localhost:3000\"\nAUTH_USERNAME = \"recommendations@reply.pinterest.com\"\nAUTH_PASSWORD = \"recommendations@reply.pinterest.com\"\nTIMEOUT = 30\n\ndef test_authentication_middleware_validates_tokens_and_prompts_reauthentication():\n    # Endpoint to test protected resource or API call that requires valid token\n    # Using the /api/ai endpoint as it requires authentication per PRD description\n\n    url = f\"{BASE_URL}/api/ai\"\n    valid_headers = {\n        \"Authorization\": f\"Basic {requests.auth._basic_auth_str(AUTH_USERNAME, AUTH_PASSWORD).split(' ')[1]}\",\n        \"Content-Type\": \"application/json\"\n    }\n    payload = {\n        \"userId\": \"validUserId123\",\n        \"prompt\": \"Hello AI\",\n        \"model\": \"test-model\"\n    }\n\n    # Step 1: Test with valid token: expect NOT a 401 or 403 error (ideally 200 or 400 for missing data)\n    try:\n        response_valid = requests.post(url, json=payload, auth=HTTPBasicAuth(AUTH_USERNAME, AUTH_PASSWORD), timeout=TIMEOUT)\n        assert response_valid.status_code != 401, f\"Valid token was rejected with status {response_valid.status_code}\"\n        assert response_valid.status_code != 403, f\"Valid token was rejected with status {response_valid.status_code}\"\n    except requests.RequestException as e:\n        assert False, f\"Request with valid token failed unexpectedly: {e}\"\n\n    # Step 2: Test with invalid token: set wrong Authorization header\n    invalid_headers = {\n        \"Authorization\": \"Basic invalidtoken1234\",\n        \"Content-Type\": \"application/json\"\n    }\n    try:\n        response_invalid = requests.post(url, headers=invalid_headers, json=payload, timeout=TIMEOUT)\n        assert response_invalid.status_code == 401, (\n            f\"Invalid token did not return 401 Unauthorized, got {response_invalid.status_code}\"\n        )\n        # Optionally check that response prompts reauthentication message\n        body = response_invalid.json()\n        assert (\"reauthenticat\" in str(body).lower() or \"token\" in str(body).lower()), (\n            \"Response does not prompt reauthentication or mention token invalidity\"\n        )\n    except requests.RequestException as e:\n        assert False, f\"Request with invalid token failed unexpectedly: {e}\"\n\n    # Step 3: Test with expired token simulation - typically would be a token string but here simulate by a typical expired token header\n    expired_headers = {\n        \"Authorization\": \"Basic \" + requests.auth._basic_auth_str(\"expiredUser\", \"expiredPass\").split(\" \")[1],\n        \"Content-Type\": \"application/json\"\n    }\n    try:\n        response_expired = requests.post(url, headers=expired_headers, json=payload, timeout=TIMEOUT)\n        # Expect 401 Unauthorized for expired tokens as well\n        assert response_expired.status_code == 401, (\n            f\"Expired token did not return 401 Unauthorized, got {response_expired.status_code}\"\n        )\n        body = response_expired.json()\n        assert (\"reauthenticat\" in str(body).lower() or \"token\" in str(body).lower()), (\n            \"Response for expired token does not prompt reauthentication or mention token expired\"\n        )\n    except requests.RequestException as e:\n        assert False, f\"Request with expired token failed unexpectedly: {e}\"\n\ntest_authentication_middleware_validates_tokens_and_prompts_reauthentication()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 68, in <module>\n  File \"<string>\", line 39, in test_authentication_middleware_validates_tokens_and_prompts_reauthentication\nAssertionError: Invalid token did not return 401 Unauthorized, got 500\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.755Z",
    "modified": "2025-12-18T19:58:26.341Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "267bc6e9-69a6-4437-b882-c7ce7deb187b",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC009-encrypted apikey storage and retrieval handles special characters",
    "description": "Verify that user-specific OpenRouter API keys are stored and retrieved in encrypted form correctly, including handling special characters without corruption.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\nimport uuid\n\nBASE_URL = \"http://localhost:3000\"\nAUTH = HTTPBasicAuth(\"recommendations@reply.pinterest.com\", \"recommendations@reply.pinterest.com\")\nTIMEOUT = 30\n\n\ndef test_encrypted_apikey_storage_and_retrieval_handles_special_characters():\n    special_api_key = \"Sp3c!@l#Key$%^&*()_+-=[]{}|;:,.<>/?`~\"\n\n    # Step 1: Create a user-specific encrypted API key with special characters by simulating storage\n    # As there's no explicit endpoint in the PRD for storing API keys, assume this is done via /api/ai with a setup user\n    # We'll simulate by calling POST /api/ai with userId and assume it stores the encrypted key, then retrieve it by calling the same endpoint.\n    # To properly test storage and retrieval, we might try to create a mock userId and use the /api/ai endpoint.\n    # Since the PRD does not show an API key storage endpoint, we will:\n    # 1. Create a page to simulate user creation/use.\n    # 2. Use /api/ai POST with userId and a prompt to trigger API key retrieval.\n    # Because API key is handled internally, we simulate the key by patching the API or by testing retrieval through usage.\n\n    # For this test, we will:\n    # - Create a page for the user to generate userId\n    # - Use the userId in /api/ai POST with a dummy message and see if the API key is processed without error.\n    # - We will embed our special characters API key in the model field as a dummy placeholder to check integrity.\n\n    # Since direct API key storage is not exposed, as a proxy we test that the API accepts special characters in the payload\n    # and the call succeeds and returns 200.\n\n    # Step 1: create a user page (simulating user creation)\n    page_data = {\n        \"title\": \"Test Page for TC009\",\n        \"content\": \"Test content\",\n        \"workspaceId\": str(uuid.uuid4())\n    }\n    created_page = None\n\n    try:\n        # Create page to get userId (simulate user)\n        create_page_resp = requests.post(\n            f\"{BASE_URL}/api/pages\",\n            json=page_data,\n            auth=AUTH,\n            timeout=TIMEOUT\n        )\n        assert create_page_resp.status_code == 200, f\"Failed to create page: {create_page_resp.text}\"\n        created_page = create_page_resp.json()\n        user_id = created_page.get(\"ownerId\") or created_page.get(\"userId\")\n        if not user_id:\n            # If response does not return userId, generate a UUID as fallback for test purpose\n            user_id = str(uuid.uuid4())\n\n        # Step 2: POST /api/ai with userId and special characters in messages or prompt to simulate encrypted key retrieval\n        prompt_with_special_chars = f\"Test prompt with special characters {special_api_key}\"\n\n        ai_request_payload = {\n            \"userId\": user_id,\n            \"prompt\": prompt_with_special_chars,\n            \"model\": \"gpt-4o-mini\",\n            \"messages\": [\n                {\"role\": \"user\", \"content\": prompt_with_special_chars}\n            ]\n        }\n\n        ai_response = requests.post(\n            f\"{BASE_URL}/api/ai\",\n            json=ai_request_payload,\n            auth=AUTH,\n            timeout=TIMEOUT\n        )\n\n        # Validate response status\n        assert ai_response.status_code == 200, f\"API response status code expected 200, got {ai_response.status_code}: {ai_response.text}\"\n\n        # Validate response content that it handles special characters without corruption\n        # Since exact response schema is unknown, check response text contains prompt special chars or a success indicator\n        response_json = ai_response.json()\n\n        # Check if any field contains the uncorrupted prompt with special characters\n        def contains_special_chars(obj):\n            if isinstance(obj, str):\n                return special_api_key in obj\n            if isinstance(obj, dict):\n                return any(contains_special_chars(v) for v in obj.values())\n            if isinstance(obj, list):\n                return any(contains_special_chars(i) for i in obj)\n            return False\n\n        assert contains_special_chars(response_json) or \"choices\" in response_json or \"generated\" in response_json, (\n            \"Response does not appear to handle special characters correctly or missing expected fields.\"\n        )\n\n    finally:\n        # Cleanup: delete the created page if exists\n        if created_page:\n            page_id = created_page.get(\"id\")\n            if page_id:\n                requests.delete(\n                    f\"{BASE_URL}/api/pages/{page_id}\",\n                    auth=AUTH,\n                    timeout=TIMEOUT\n                )\n\n\ntest_encrypted_apikey_storage_and_retrieval_handles_special_characters()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 105, in <module>\n  File \"<string>\", line 89, in test_encrypted_apikey_storage_and_retrieval_handles_special_characters\nAssertionError: Response does not appear to handle special characters correctly or missing expected fields.\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.761Z",
    "modified": "2025-12-18T19:58:58.416Z"
  },
  {
    "projectId": "6f7d85ef-d42f-4bd6-98b5-10d291a728b3",
    "testId": "a77442f4-3038-4e64-a995-15a0eb4d0a31",
    "userId": "a4e84458-30b1-70b8-4f57-9606bf05875c",
    "title": "TC010-page deletion cascades to remove associated subdocuments",
    "description": "Verify that deleting a page via the Pages API properly cascades or cleans associated hierarchical blocks and subdocuments to avoid orphaned data or remnants.",
    "code": "import requests\nfrom requests.auth import HTTPBasicAuth\nimport uuid\nimport time\n\nBASE_URL = \"http://localhost:3000\"\nAUTH_USERNAME = \"recommendations@reply.pinterest.com\"\nAUTH_PASSWORD = \"recommendations@reply.pinterest.com\"\nAUTH = HTTPBasicAuth(AUTH_USERNAME, AUTH_PASSWORD)\nTIMEOUT = 30\n\n\ndef test_page_deletion_cascades_to_remove_associated_subdocuments():\n    # Create a new page resource with associated subdocuments (simulate with nested blocks)\n    create_page_url = f\"{BASE_URL}/api/pages\"\n    # Sample payload assuming API accepts a page with a blocks/subdocuments field for hierarchy\n    page_data = {\n        \"title\": \"Test Page for Deletion Cascade\",\n        \"content\": \"Root page content\",\n        \"blocks\": [\n            {\n                \"type\": \"block\",\n                \"content\": \"Parent block\",\n                \"subblocks\": [\n                    {\n                        \"type\": \"subblock\",\n                        \"content\": \"Child subblock 1\"\n                    },\n                    {\n                        \"type\": \"subblock\",\n                        \"content\": \"Child subblock 2\"\n                    }\n                ]\n            }\n        ],\n        \"workspaceId\": \"test-workspace-id\"\n    }\n\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n\n    page_id = None\n    try:\n        # Create the page\n        create_resp = requests.post(\n            create_page_url,\n            json=page_data,\n            auth=AUTH,\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        assert create_resp.status_code == 201 or create_resp.status_code == 200, \\\n            f\"Page creation failed: {create_resp.status_code}, {create_resp.text}\"\n        created_page = create_resp.json()\n        assert \"id\" in created_page or \"_id\" in created_page, \"Created page response missing ID\"\n        page_id = created_page.get(\"id\") or created_page.get(\"_id\")\n        assert page_id is not None\n\n        # Optionally wait a moment for any asynchronous cascade processes\n        time.sleep(1)\n\n        # Delete the page\n        delete_url = f\"{BASE_URL}/api/pages/{page_id}\"\n        delete_resp = requests.delete(\n            delete_url,\n            auth=AUTH,\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        assert delete_resp.status_code == 200 or delete_resp.status_code == 204, \\\n            f\"Page deletion failed: {delete_resp.status_code}, {delete_resp.text}\"\n\n        # Check that the page is deleted: expect 404 or similar when fetching page\n        get_page_resp = requests.get(\n            delete_url,\n            auth=AUTH,\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        assert get_page_resp.status_code == 404, \\\n            f\"Deleted page still accessible: {get_page_resp.status_code}, {get_page_resp.text}\"\n\n        # Verify no orphaned subdocuments or blocks exist\n        # Since the API spec doesn't specify an endpoint for blocks or subdocuments,\n        # attempt to query blocks or subdocuments related to the page\n        # E.g., GET /api/pages/{page_id}/blocks or /api/blocks?parentId=page_id\n        # First try GET blocks under page (may need adjustments if API differs)\n\n        blocks_url = f\"{BASE_URL}/api/pages/{page_id}/blocks\"\n        blocks_resp = requests.get(\n            blocks_url,\n            auth=AUTH,\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        # Expect 404 or empty list (depending on API behavior)\n        if blocks_resp.status_code == 200:\n            blocks = blocks_resp.json()\n            assert not blocks, \"Orphaned blocks found after page deletion\"\n        else:\n            # 404 or other error acceptable meaning no blocks exist\n            assert blocks_resp.status_code == 404 or blocks_resp.status_code == 400 or blocks_resp.status_code == 204\n\n        # Optionally, check for subdocuments if separate endpoint exists, try /api/pages/{page_id}/subdocuments\n        subdocs_url = f\"{BASE_URL}/api/pages/{page_id}/subdocuments\"\n        subdocs_resp = requests.get(\n            subdocs_url,\n            auth=AUTH,\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        if subdocs_resp.status_code == 200:\n            subdocs = subdocs_resp.json()\n            assert not subdocs, \"Orphaned subdocuments found after page deletion\"\n        else:\n            assert subdocs_resp.status_code == 404 or subdocs_resp.status_code == 400 or subdocs_resp.status_code == 204\n\n    finally:\n        # Cleanup: in case the page was not deleted, delete it now\n        if page_id:\n            requests.delete(\n                f\"{BASE_URL}/api/pages/{page_id}\",\n                auth=AUTH,\n                headers=headers,\n                timeout=TIMEOUT\n            )\n\n\ntest_page_deletion_cascades_to_remove_associated_subdocuments()\n",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T19:57:45.766Z",
    "modified": "2025-12-18T19:58:33.300Z"
  }
]
